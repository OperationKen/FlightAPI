<!DOCTYPE html>
<html> 
    <head>
        <title>Flight</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" href="styles.css" />
        <style>
            #home-list {
                background-color: #f0f4f7;
            }
            .boxes {
                padding: 50px;
            }
            .submit-button{
                background-color: #f78f20;
                border: none;
            }
        </style>
        <script>
            var house = {};
            document.addEventListener("DOMContentLoaded", function(){
                document.getElementById("new-home").addEventListener("submit", function(e){
                    e.preventDefault();
                    var address = document.getElementById("address").value;
                    var price = document.getElementById("price").value;
                    house = { address: address, price: price};
                    console.log(house);

                    updateTable(house);

                    document.getElementById("address").value = null;
                    document.getElementById("price").value = null;

                });
            });

            var updateTable = function(home){
                var row = document.createElement("TR");
                var addressColumn = document.createElement("TD");
                var priceColumn = document.createElement("TD");
                addressColumn.innerText = home.address;
                priceColumn.innerText = home.price;
                row.appendChild(addressColumn);
                row.appendChild(priceColumn);
                document.getElementById("home-table").appendChild(row);
            };

        </script>
    </head>
    <body>
        <div class="container-fluid">
            <div><h1>Flight App</h1></div>
            <div class="row">
                <div class="col-lg-6">
                    <h2>Add Flight</h2>
                    <form id="new-home" action = "#">
                        <div class="form-group">
                            <label>From</label>
                            <input class="form-control" id="fromAirport" type="text" />
                        </div>
                        <div class="form-group">
                            <label>To</label>
                            <input class="form-control" id="toAirport" type="text" />
                        </div>
                        <div class="form-group">
                            <label>Departure</label>
                            <input class="form-control" id="departure" type="text" />
                        </div>
                        <div class="form-group">
                            <label>Arrival</label>
                            <input class="form-control" id="arrival" type="text" />
                        </div>
                        <div class="form-group">
                            <label>Flight Number</label>
                            <input class="form-control" id="flightNum" type="text" />
                        </div>
                        <div>
                            <input class="btn btn-primary submit-button" type="submit" value="Add" />
                        </div>
                    </form>
                </div>
                <div id="flight-data" class="col-lg-6">
                    <h2>View Flights</h2>
                    <table class="table" id="flight-data">
                        <tr><th>From</th><th>To</th><th>Departure</th><th>Arrival</th><th>Flight Number</th></tr>
                        <tr><td>USA</td><td>USA</td><td>2020-04-23</td><td>2020-04-23</td><td>34343-343</td></tr>
                    </table>
                </div>
            </div>
        </div>
    </body>
    <script type="text/javascript">
                        
        window.onload = function(){
            let xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(response){
                if(xhr.readyState === 4){
                    console.log(xhr.responseText)
                    var flightArray = JSON.parse(xhr.responseText)
                    flightArray.forEach(flight => {
                        addFlightsRecordToTable(flight)
                    })
                }
            }

            xhr.open('GET', '/flight-api/flight');
            xhr.send();

            function addFlightsRecordToTable(flight){
                console.log('adding to table')
                var tr = document.createElement('tr');
                var from = document.createElement('td');
                var to = document.createElement('td');
                var departure = document.createElement('td');
                var arrival = document.createElement('td');
                var flightNum = document.createElement('td');
                from.innerText = flight.fromAirport;
                to.innerText = flight.toAirport;
                departure.innerText = flight.departure;
                arrival.innerText = flight.arrival;
                flightNum.innerText = flight.flightNumber;
                tr.appendChild(from);
                tr.appendChild(to);
                tr.appendChild(departure);
                tr.appendChild(arrival);
                tr.appendChild(flightNum);
                document.getElementById('flight-data').appendChild(tr)

            }
        }
        </script>
</html>